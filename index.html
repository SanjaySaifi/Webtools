<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Frame Extractor</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: #111;
    font-family: system-ui, -apple-system, sans-serif;
    color: #fff;
}

/* APP */
#app {
    position: relative;
    height: 100%;
    width: 100%;
}

/* TOP BAR (UPLOAD) */
#top-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: #222;
    padding: 10px;
    text-align: center;
    z-index: 10;
}

#top-bar input {
    font-size: 16px; /* üî• readable on mobile */
}

/* INFO BAR */
#info {
    position: fixed;
    top: 52px;
    left: 0;
    right: 0;
    background: #181818;
    font-size: 14px; /* üî• readable */
    padding: 6px 10px;
    display: flex;
    justify-content: space-around;
    z-index: 10;
}

/* VIDEO VIEW */
#viewer {
    position: absolute;
    top: 96px;        /* below top + info */
    bottom: 70px;     /* above controls */
    left: 0;
    right: 0;
    background: black;
    display: flex;
    align-items: center;
    justify-content: center;
}

video {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

/* CONTROLS (FIXED BOTTOM) */
#controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #222;
    padding: 10px;
    display: flex;
    gap: 10px;
    z-index: 10;
}

button {
    flex: 1;
    font-size: 16px;   /* üî• readable */
    padding: 14px;
    border-radius: 8px;
    border: none;
    background: #444;
    color: #fff;
}

/* CANVAS */
canvas {
    display: none;
}

/* SMALL HEIGHT LANDSCAPE */
@media (max-height: 450px) {
    #info {
        display: none;
    }
    #viewer {
        top: 52px;
    }
}
</style>
</head>

<body>

<div id="app">

    <!-- Upload -->
    <div id="top-bar">
        <input type="file" accept="video/mp4" id="videoInput">
    </div>

    <!-- Info -->
    <div id="info">
        <span id="videoSize">Video: ‚Äî</span>
        <span id="videoRes">Res: ‚Äî</span>
        <span id="frameSize">Frame: ‚Äî</span>
    </div>

    <!-- Viewer -->
    <div id="viewer">
        <video id="video" controls playsinline></video>
    </div>

    <!-- Controls -->
    <div id="controls">
        <button onclick="prevFrame()">‚èÆ Prev</button>
        <button onclick="nextFrame()">‚è≠ Next</button>
        <button onclick="exportFrame()">üì∏ Export</button>
    </div>

</div>

<canvas id="canvas"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const videoSizeEl = document.getElementById("videoSize");
const videoResEl = document.getElementById("videoRes");
const frameSizeEl = document.getElementById("frameSize");

let frameRate = 30;

document.getElementById("videoInput").addEventListener("change", function () {
    const file = this.files[0];
    video.src = URL.createObjectURL(file);

    videoSizeEl.textContent =
        `Video: ${(file.size / (1024 * 1024)).toFixed(2)} MB`;

    video.onloadedmetadata = () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        videoResEl.textContent =
            `Res: ${video.videoWidth}√ó${video.videoHeight}`;

        updateFrameSizeInfo();
    };
});

function updateFrameSizeInfo() {
    const mb = (canvas.width * canvas.height * 3 / (1024 * 1024)).toFixed(1);
    frameSizeEl.textContent =
        `Frame: ${canvas.width}√ó${canvas.height} ‚âà ${mb} MB`;
}

function drawFrame() {
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
}

video.addEventListener("seeked", drawFrame);

function nextFrame() {
    video.currentTime += 1 / frameRate;
}

function prevFrame() {
    video.currentTime -= 1 / frameRate;
}

function exportFrame() {
    drawFrame();
    const link = document.createElement("a");
    link.download = `frame_${canvas.width}x${canvas.height}.bmp`;
    link.href = canvas.toDataURL("image/bmp");
    link.click();
}
</script>

</body>
</html>
