<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Frame Extractor</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: #ffffff;
}

#app {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* TOP BAR */
#top-bar {
    background: #2b2b2b;
    padding: 6px;
    display: flex;
    justify-content: center;
}

/* INFO BAR */
#info {
    background: #1a1a1a;
    font-size: 12px;
    padding: 4px 8px;
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 6px;
}

/* VIDEO AREA */
#viewer {
    flex: 1;
    min-height: 0;
    background: black;
    display: flex;
    align-items: center;
    justify-content: center;
}

video {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

/* CONTROLS */
#controls {
    background: #2b2b2b;
    padding: 6px;
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
}

button, input {
    padding: 10px 14px;
    font-size: 14px;
    border-radius: 6px;
}

/* CANVAS */
canvas {
    display: none;
}

/* üì± MOBILE OPTIMIZATION */
@media (max-width: 768px) {

    #info {
        font-size: 11px;
        text-align: center;
    }

    button {
        flex: 1 1 30%;
        font-size: 13px;
        padding: 12px;
    }

    #controls {
        gap: 6px;
    }
}

/* üì± LANDSCAPE MOBILE */
@media (max-height: 500px) {
    #info {
        display: none;
    }
}
</style>
</head>

<body>

<div id="app">

    <div id="top-bar">
        <input type="file" accept="video/mp4" id="videoInput">
    </div>

    <div id="info">
        <span id="videoSize">Video: ‚Äî</span>
        <span id="videoRes">Resolution: ‚Äî</span>
        <span id="frameSize">Frame Export: ‚Äî</span>
    </div>

    <div id="viewer">
        <video id="video" controls playsinline></video>
    </div>

    <div id="controls">
        <button onclick="prevFrame()">‚èÆ Prev</button>
        <button onclick="nextFrame()">‚è≠ Next</button>
        <button onclick="exportFrame()">üì∏ Export (BMP)</button>
    </div>

</div>

<canvas id="canvas"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const videoSizeEl = document.getElementById("videoSize");
const videoResEl = document.getElementById("videoRes");
const frameSizeEl = document.getElementById("frameSize");

let frameRate = 30;

document.getElementById("videoInput").addEventListener("change", function () {
    const file = this.files[0];
    video.src = URL.createObjectURL(file);

    const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
    videoSizeEl.textContent = `Video: ${sizeMB} MB`;

    video.onloadedmetadata = () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        videoResEl.textContent =
            `Resolution: ${video.videoWidth} √ó ${video.videoHeight}`;

        updateFrameSizeInfo();
    };
});

function updateFrameSizeInfo() {
    const bytes = canvas.width * canvas.height * 3;
    const sizeMB = (bytes / (1024 * 1024)).toFixed(2);
    frameSizeEl.textContent =
        `Frame Export: ${canvas.width}√ó${canvas.height} ‚âà ${sizeMB} MB (BMP)`;
}

function drawFrame() {
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
}

video.addEventListener("seeked", drawFrame);

function nextFrame() {
    video.currentTime += 1 / frameRate;
}

function prevFrame() {
    video.currentTime -= 1 / frameRate;
}

function exportFrame() {
    drawFrame();
    const link = document.createElement("a");
    link.download = `frame_${canvas.width}x${canvas.height}.bmp`;
    link.href = canvas.toDataURL("image/bmp");
    link.click();
}
</script>

</body>
</html>
